#ifndef __PARAMS__
#define __PARAMS__

#include <stdint.h>

namespace hgsw_params {
    
    class prm {
    public:
        static constexpr const uint16_t n = 61; // MLWE secret key dimension over Rq
        static constexpr const uint16_t p = 19; // the plaintext modulus
        static constexpr const uint16_t nu = 32; // number of ciphertexts in re-randomization privacy analysis
        static constexpr const uint16_t mq = 3; // number of digits of q base beta
        static constexpr const uint16_t d = 32; // ring dimension 
        static constexpr const uint16_t s = 2; // Gaussian parameter for initial LWE error
        static constexpr const uint16_t tau = 1; // sparsification parameter
        static constexpr const uint32_t beta = 52016ULL; // base used to compute mq
        static constexpr const uint16_t ell_p = 2; // number of ring splitting factors mod p
        static constexpr const uint16_t f = 16; // degree of the irreducible factors of x^d + 1 mod p
        static constexpr const uint16_t f_num = 2; // number of phi matrices used in CRT (from params.hpp)
        static constexpr const uint16_t ell = 6; // the plaintext dimension over Rp 
        static constexpr const uint16_t ell_pr = 7; // extended plaintext dimension over Rp (ell_pr = ell + tau)
        static constexpr const uint16_t rho = 3; // number of repetitions for knowledge amplification
        static constexpr const uint16_t w = 4 * rho; // 4rho, used to encode a plaintext vector qi
        static constexpr const uint16_t v = w / ell_p; // auxiliary parameter used in CRT-Decode
        static constexpr const uint16_t zero = 0;
        
        static constexpr const double sig_s = 0.797884560802839; // sig_s = s / sqrt(2 * pi)   
        static constexpr const double sig_rx = 5330613.023084628; // sig_rx = rx / sqrt(2 * pi)
        static constexpr const double sig_ry = 3779236.7927396325; // sig_ry = ry / sqrt(2 * pi)
        static constexpr const double sig_r = 493497539448.708; // sig_r = r / sqrt(2 * pi)

        static constexpr const uint64_t q = 140737488364243ULL; // the ciphertext modulus before mod switching
        static constexpr const uint16_t q_bit = 47; // (bit length of q) - 1
        static constexpr const uint64_t q_bitmask = (1ULL << (q_bit + 1)) - 1; // bitmask used in computations               
                
        static constexpr const uint64_t m[3] = {2048, 8192, 32768}; 

        static constexpr const uint64_t qpr = 893779; // the ciphertext modulus after mod switching
        static constexpr const uint64_t qprop = 47041; // qpr / p
        static constexpr const uint64_t qprop_inv = 6; // qprop^-1 mod p;                
                            
        static constexpr const double poq = 0.00000000000013500311978586727823193850142162514885; // p / q; 
        static constexpr const double poqpr = 0.00002125805148700070018662026949396448571860673837; // p / qpr; 
        static constexpr const double qproq = 0.00000000635068175784698226579354926536920278312692; // qpr / q; 
                              
        static constexpr const uint64_t qbar = 7407236229697ULL; // NTT friendly prime
        static constexpr const uint16_t qbar_bit = 42; // (bit length of qbar) - 1        
        static constexpr const uint64_t qbar_bitmask = (1ULL << (qbar_bit + 1)) - 1; // bitmask used in computations 
        static constexpr const uint64_t qbmp = 1716351494493ULL; // NTT(qbar mod p)
        static constexpr const uint64_t qb_inv = 10; // qbar^-1 mod p;
        
        static constexpr const uint16_t rp_shift = 64;
        static constexpr const __uint128_t rp_r_qbar = (((__uint128_t)9059340574690479130ULL)<<64)|1653381282117576129ULL;
        static constexpr const __uint128_t rp_conv_fact_qbar = (((__uint128_t)11360545456038168515ULL)<<64)|14119527396004498083ULL;
        static constexpr const __uint128_t inv_n_qbar = (((__uint128_t)5471251163689888864ULL)<<64)|15039647724955184943ULL;
        
        static constexpr const __uint128_t rp_r_qprop = (((__uint128_t)10923502963739148185ULL)<<64)|17533053597492140097ULL;
        static constexpr const __uint128_t rp_conv_fact_qprop = (((__uint128_t)12851664367842587000ULL)<<64)|17320120580931601705ULL;
        static constexpr const __uint128_t inv_n_qprop = (((__uint128_t)9564731504471624188ULL)<<64)|14959426732507216579ULL;       
        
        /* root table to convert to plantard form (mod qbar) */
        static constexpr const __uint128_t root_qbar[d] = {(((__uint128_t)0ULL)<<64)|1ULL,(((__uint128_t)7605124455599383738ULL)<<64)|14075223623556095284ULL,(((__uint128_t)913624299643268077ULL)<<64)|16669172059936531487ULL,(((__uint128_t)3180936520052992518ULL)<<64)|5262156365366675199ULL,(((__uint128_t)7818870465232931638ULL)<<64)|7128587019404558236ULL,(((__uint128_t)8297424812796542276ULL)<<64)|5994705887733069886ULL,(((__uint128_t)15539646615168083705ULL)<<64)|16308392294442523600ULL,(((__uint128_t)17252069894008781650ULL)<<64)|7338113310654413370ULL,(((__uint128_t)15523298551842845736ULL)<<64)|1358429360564927729ULL,(((__uint128_t)11608166659342856227ULL)<<64)|2675078894422612972ULL,(((__uint128_t)2477487633896003607ULL)<<64)|129029230030309603ULL,(((__uint128_t)13675531984420843848ULL)<<64)|10996932973660126307ULL,(((__uint128_t)4766329182918215410ULL)<<64)|10068920367743744183ULL,(((__uint128_t)8270794590956665516ULL)<<64)|12213516381644837843ULL,(((__uint128_t)6549488743116799037ULL)<<64)|8470420653927220995ULL,(((__uint128_t)14269829478164284350ULL)<<64)|4847077902119795305ULL,(((__uint128_t)6606805684835325358ULL)<<64)|7076223473352465535ULL,(((__uint128_t)11331742267532320474ULL)<<64)|7856022095786582625ULL,(((__uint128_t)11668454487414647413ULL)<<64)|11351369082223339105ULL,(((__uint128_t)14369320764273400198ULL)<<64)|3621480656698055005ULL,(((__uint128_t)13556606344579163227ULL)<<64)|10380796439915414989ULL,(((__uint128_t)7535112873588215926ULL)<<64)|6764320727743190531ULL,(((__uint128_t)17251649512748032855ULL)<<64)|7385582539910633573ULL,(((__uint128_t)16836541738880884225ULL)<<64)|10222864650765135000ULL,(((__uint128_t)2975271090741457939ULL)<<64)|4269928981199770801ULL,(((__uint128_t)2140433350074900767ULL)<<64)|15095696716665913950ULL,(((__uint128_t)10337316143624506522ULL)<<64)|14377785260884290320ULL,(((__uint128_t)7902851097061056246ULL)<<64)|17156328381775955378ULL,(((__uint128_t)14753713402650005258ULL)<<64)|14104994187221046975ULL,(((__uint128_t)15983020250935024173ULL)<<64)|17742562354795946854ULL,(((__uint128_t)15061637452955250181ULL)<<64)|4468856641535774167ULL,(((__uint128_t)4361074318624996ULL)<<64)|4598345790795769068ULL};
        
        /* inverse root table to convert from plantard form (mod qbar) */
        static constexpr const __uint128_t root_inv_qbar[d] = {(((__uint128_t)0ULL)<<64)|1ULL,(((__uint128_t)16450124966448192855ULL)<<64)|9678287387432274768ULL,(((__uint128_t)15265807553656559097ULL)<<64)|13184587708342876418ULL,(((__uint128_t)17533119774066283538ULL)<<64)|1777572013773020130ULL,(((__uint128_t)1194674179700769965ULL)<<64)|11108630763055138247ULL,(((__uint128_t)2907097458541467910ULL)<<64)|2138351779267028017ULL,(((__uint128_t)10149319260913009339ULL)<<64)|12452038185976481731ULL,(((__uint128_t)10627873608476619977ULL)<<64)|11318157054304993381ULL,(((__uint128_t)4176914595545267265ULL)<<64)|13599666171589756312ULL,(((__uint128_t)11897255330592752578ULL)<<64)|9976323419782330622ULL,(((__uint128_t)10175949482752886099ULL)<<64)|6233227692064713774ULL,(((__uint128_t)13680414890791336205ULL)<<64)|8377823705965807434ULL,(((__uint128_t)4771212089288707767ULL)<<64)|7449811100049425310ULL,(((__uint128_t)15969256439813548008ULL)<<64)|18317714843679242014ULL,(((__uint128_t)6838577414366695388ULL)<<64)|15771665179286938645ULL,(((__uint128_t)2923445521866705879ULL)<<64)|17088314713144623888ULL,(((__uint128_t)18442382999390926619ULL)<<64)|13848398282913782549ULL,(((__uint128_t)3385106620754301434ULL)<<64)|13977887432173777450ULL,(((__uint128_t)2463723822774527442ULL)<<64)|704181718913604763ULL,(((__uint128_t)3693030671059546357ULL)<<64)|4341749886488504642ULL,(((__uint128_t)10543892976648495369ULL)<<64)|1290415691933596239ULL,(((__uint128_t)8109427930085045093ULL)<<64)|4068958812825261297ULL,(((__uint128_t)16306310723634650848ULL)<<64)|3351047357043637667ULL,(((__uint128_t)15471472982968093676ULL)<<64)|14176815092509780816ULL,(((__uint128_t)1610202334828667390ULL)<<64)|8223879422944416617ULL,(((__uint128_t)1195094560961518760ULL)<<64)|11061161533798918044ULL,(((__uint128_t)10911631200121335689ULL)<<64)|11682423345966361086ULL,(((__uint128_t)4890137729130388388ULL)<<64)|8065947633794136628ULL,(((__uint128_t)4077423309436151417ULL)<<64)|14825263417011496612ULL,(((__uint128_t)6778289586294904202ULL)<<64)|7095374991486212512ULL,(((__uint128_t)7115001806177231141ULL)<<64)|10590721977922968992ULL,(((__uint128_t)11839938388874226257ULL)<<64)|11370520600357086082ULL};
        
        /* root table to convert to plantard form (mod qpr/p) */
        static constexpr const __uint128_t root_qprop[d] = {(((__uint128_t)0ULL)<<64)|1ULL,(((__uint128_t)17288749234108686287ULL)<<64)|7623629419803732765ULL,(((__uint128_t)8333013999836907630ULL)<<64)|6733075311868221366ULL,(((__uint128_t)1572096617663348832ULL)<<64)|8796525649145482916ULL,(((__uint128_t)9083573472575158981ULL)<<64)|3059882740740112482ULL,(((__uint128_t)12750491774338684781ULL)<<64)|4399439250078600787ULL,(((__uint128_t)17653048999089791566ULL)<<64)|16182124974930344955ULL,(((__uint128_t)2173250051157465509ULL)<<64)|18431842683968666793ULL,(((__uint128_t)1614840077709571088ULL)<<64)|1599938687968686266ULL,(((__uint128_t)8957695943448210870ULL)<<64)|11222315042227417533ULL,(((__uint128_t)4407674228619616083ULL)<<64)|1347791487879503602ULL,(((__uint128_t)17533445739327426539ULL)<<64)|13134006489248825754ULL,(((__uint128_t)14605322655243558809ULL)<<64)|1470924024159446613ULL,(((__uint128_t)7091492949320030004ULL)<<64)|2188151440898350334ULL,(((__uint128_t)15084127836128305360ULL)<<64)|8351052524260083996ULL,(((__uint128_t)2772834917310436416ULL)<<64)|12423053341874505117ULL,(((__uint128_t)10108632230013920230ULL)<<64)|6987183221133836243ULL,(((__uint128_t)9396894798969026708ULL)<<64)|1247011036210887825ULL,(((__uint128_t)14546893521785878844ULL)<<64)|18247143879548752276ULL,(((__uint128_t)16456624259630854852ULL)<<64)|9460029634450143985ULL,(((__uint128_t)11834448447109554605ULL)<<64)|17826375690286399246ULL,(((__uint128_t)16537797619535148493ULL)<<64)|16609167433557281068ULL,(((__uint128_t)16014288269427747473ULL)<<64)|6593864960341534203ULL,(((__uint128_t)17724810954947210583ULL)<<64)|3253600807371615182ULL,(((__uint128_t)11492892908575063003ULL)<<64)|14746493715946678186ULL,(((__uint128_t)13590459585522245070ULL)<<64)|6996594625180710868ULL,(((__uint128_t)7529515379334986513ULL)<<64)|8149883762758138884ULL,(((__uint128_t)13487718424677197079ULL)<<64)|15325295064829467629ULL,(((__uint128_t)16407606530220049513ULL)<<64)|9420423309086213271ULL,(((__uint128_t)15718221183786483225ULL)<<64)|14471210147575595402ULL,(((__uint128_t)18175774065526619701ULL)<<64)|18375374259687419043ULL,(((__uint128_t)15451956877626988624ULL)<<64)|5991927243176844640ULL};

        /* inverse root table to convert from plantard form (mod qpr/p) */
        static constexpr const __uint128_t root_inv_qprop[d] = {(((__uint128_t)0ULL)<<64)|1ULL,(((__uint128_t)9401600500992464020ULL)<<64)|11285842019543821252ULL,(((__uint128_t)16874647456046202783ULL)<<64)|9650218424564068701ULL,(((__uint128_t)10113730073872643985ULL)<<64)|11713668761841330251ULL,(((__uint128_t)16273494022552086106ULL)<<64)|14901389740884824ULL,(((__uint128_t)793695074619760049ULL)<<64)|2264619098779206662ULL,(((__uint128_t)5696252299370866834ULL)<<64)|14047304823630950830ULL,(((__uint128_t)9363170601134392634ULL)<<64)|15386861332969439135ULL,(((__uint128_t)15673909156399115199ULL)<<64)|6023690731835046500ULL,(((__uint128_t)3362616237581246255ULL)<<64)|10095691549449467621ULL,(((__uint128_t)11355251124389521611ULL)<<64)|16258592632811201283ULL,(((__uint128_t)3841421418465992806ULL)<<64)|16975820049550105004ULL,(((__uint128_t)913298334382125076ULL)<<64)|5312737584460725863ULL,(((__uint128_t)14039069845089935532ULL)<<64)|17098952585830048015ULL,(((__uint128_t)9489048130261340745ULL)<<64)|7224429031482134084ULL,(((__uint128_t)16831903995999980527ULL)<<64)|16846805385740865351ULL,(((__uint128_t)2994787196082562991ULL)<<64)|12454816830532706977ULL,(((__uint128_t)270970008182931914ULL)<<64)|71369814022132574ULL,(((__uint128_t)2728522889923068390ULL)<<64)|3975533926133956215ULL,(((__uint128_t)2039137543489502102ULL)<<64)|9026320764623338346ULL,(((__uint128_t)4959025649032354536ULL)<<64)|3121449008880083988ULL,(((__uint128_t)10917228694374565102ULL)<<64)|10296860310951412733ULL,(((__uint128_t)4856284488187306545ULL)<<64)|11450149448528840749ULL,(((__uint128_t)6953851165134488612ULL)<<64)|3700250357762873431ULL,(((__uint128_t)721933118762341032ULL)<<64)|15193143266337936435ULL,(((__uint128_t)2432455804281804142ULL)<<64)|11852879113368017414ULL,(((__uint128_t)1908946454174403122ULL)<<64)|1837576640152270549ULL,(((__uint128_t)6612295626599997010ULL)<<64)|620368383423152371ULL,(((__uint128_t)1990119814078696763ULL)<<64)|8986714439259407632ULL,(((__uint128_t)3899850551923672771ULL)<<64)|199600194160799341ULL,(((__uint128_t)9049849274740524907ULL)<<64)|17199733037498663792ULL,(((__uint128_t)8338111843695631385ULL)<<64)|11459560852575715374ULL};


        static constexpr const uint16_t PHI_19[f_num][f][f] = { { {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,18,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,18,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,18,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18} }, { {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,18,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18},{0,0,0,0,1,0,0,0,0,0,0,0,6,0,0,0},{0,13,0,0,0,0,0,0,0,1,0,0,0,0,0,0},{0,0,0,0,0,0,6,0,0,0,0,0,0,0,18,0},{0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,18,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0},{0,0,18,0,0,0,0,0,0,0,13,0,0,0,0,0},{0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,6},{0,0,0,0,13,0,0,0,0,0,0,0,1,0,0,0},{0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,0} } };
    
    static constexpr const uint16_t PHI_19_pr[f_num][f][f] = { { {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,18,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,18,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,18,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18} }, { {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0},{0,0,13,0,0,0,0,0,0,0,18,0,0,0,0,0},{0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0},{0,0,0,0,18,0,0,0,0,0,0,0,6,0,0,0},{0,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},{0,0,0,6,0,0,0,0,0,0,0,1,0,0,0,0},{0,0,0,0,0,0,0,0,18,0,0,0,0,0,0,0},{0,0,0,0,0,1,0,0,0,0,0,0,0,13,0,0},{0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18},{0,0,0,0,13,0,0,0,0,0,0,0,18,0,0,0},{0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0},{0,0,0,0,0,0,18,0,0,0,0,0,0,0,6,0},{0,0,0,18,0,0,0,0,0,0,0,0,0,0,0,0} } }; 
    };
}

#endif
